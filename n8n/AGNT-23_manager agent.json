{
  "name": "AGNT-23_manager agent",
  "nodes": [
    {
      "parameters": {
        "public": true,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.1,
      "position": [
        0,
        0
      ],
      "id": "896ee1b2-8316-4375-8cd9-fce311b7acd9",
      "name": "When chat message received",
      "webhookId": "e1af5a6a-a26f-4fe1-99a0-4ac196d4c42c"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "claude-sonnet-4-20250514",
          "mode": "list",
          "cachedResultName": "Claude Sonnet 4"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
      "typeVersion": 1.3,
      "position": [
        60,
        200
      ],
      "id": "0f915ca9-471d-4221-af5c-bf9ee1c8ae09",
      "name": "Anthropic Chat Model",
      "credentials": {
        "anthropicApi": {
          "id": "wbeNANi1PbARphs8",
          "name": "Anthropic account"
        }
      }
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        300,
        280
      ],
      "id": "c9d9ba6b-7dd8-44f9-b453-c1f8b0817911",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "bgHD6xjEhV21QfJ7",
          "mode": "list",
          "cachedResultName": "My project ‚Äî AGNT_21_CompetitorResearchAgent Manager"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "query": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('query', ``, 'string') }}"
          },
          "matchingColumns": [
            "query"
          ],
          "schema": [
            {
              "id": "query",
              "displayName": "query",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 2.2,
      "position": [
        460,
        340
      ],
      "id": "ea644b5f-43e7-4056-bb60-e9419e1bf59d",
      "name": "Research Agent"
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "x9v14SwF775vesaZ",
          "mode": "list",
          "cachedResultName": "My project ‚Äî AGNT-22 Visualization Agent copy"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "query": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('query', ``, 'string') }}"
          },
          "matchingColumns": [
            "query"
          ],
          "schema": [
            {
              "id": "query",
              "displayName": "query",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 2.2,
      "position": [
        580,
        200
      ],
      "id": "bed29bad-7a8b-48f0-8684-5d9bb9d3b63e",
      "name": "Visualization Agent"
    },
    {
      "parameters": {
        "needsFallback": true,
        "options": {
          "systemMessage": "=## ROLE & RESPONSIBILITY\n\nYou are a Manager Agent responsible for coordinating between a Research Agent and a Visualization Agent. Your primary function is to:\n- Analyze incoming user requests to determine task requirements\n- Route tasks to the appropriate specialist agent(s)\n- Coordinate multi-agent workflows when both research and visualization are needed\n- Consolidate and present final outputs to users\n- Make no direct tool calls or API requests ‚Äì you delegate all execution work\n\n## AVAILABLE TOOLS\n\n- Research Agent: Deploy for data gathering, analysis, fact-checking, market research, competitive analysis, literature reviews, and information synthesis\n- Visualization Agent: Deploy for creating charts, graphs, dashboards, infographics, data presentations, and visual content\n- No direct tools or APIs available to you\n\n## WORKFLOW PROCESS\n\n1.  **Input Analysis:** Parse user request to identify:\n    - Information gathering needs (triggers Research Agent)\n    - Visual output requirements (triggers Visualization Agent)\n    - Dependencies between research and visualization tasks\n\n2.  **Agent Routing:**\n    - Single agent: Route directly to Research OR Visualization Agent\n    - Sequential: Research first, then Visualization using research output\n    - Parallel: Independent research and visualization tasks\n\n3.  **Coordination:**\n    - Monitor agent progress and outputs\n    - Ensure research data is properly formatted for visualization needs\n    - Handle handoffs between agents\n\n4.  **Output Integration:** Compile agent outputs into cohesive final response\n\n## IMPORTANT GUARDRAILS\n\n- Never attempt direct research or visualization ‚Äì always delegate\n- Do not make assumptions about data availability ‚Äì confirm with Research Agent first\n- Escalate to human if agents cannot fulfill requirements or produce contradictory outputs\n- Reject requests for harmful, misleading, or inappropriate content creation\n\n## OUTPUT SPECIFICATIONS\n\n- Format: Present integrated response combining both agents' work\n- Structure: Lead with key findings, follow with supporting visuals\n- Attribution: Clearly indicate which content came from which agent\n- Completeness: Ensure user's original request is fully addressed\n\n**Example Routing Logic:**\n- \"Research competitor pricing\" -> Research Agent only\n- \"Create sales dashboard\" -> Visualization Agent only\n- \"Analyze market trends and create report with charts\" -> Research Agent -> Visualization Agent (sequential)"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        220,
        0
      ],
      "id": "c1a284c2-0cb5-40a0-b46f-a8f1cefa86cf",
      "name": "Manager Agent"
    },
    {
      "parameters": {
        "content": "## üéØ Manager Agent - Sistema de Coordinaci√≥n de Agentes IA\n\n**Prop√≥sito:** Este workflow funciona como un coordinador inteligente que distribuye tareas entre agentes especializados.\n\n**C√≥mo funciona:**\n- Recibe consultas v√≠a chat\n- Analiza si necesita investigaci√≥n, visualizaci√≥n o ambas\n- Delega tareas a los agentes apropiados\n- Consolida resultados finales\n\n**Ejemplo de uso:** \"Comparativa entre Banco Bisa y Banco Nacional\" activar√° primero el Research Agent para recopilar datos, luego el Visualization Agent para crear gr√°ficos comparativos.",
        "height": 200,
        "width": 400,
        "color": 4
      },
      "id": "note-main-explanation",
      "name": "Nota Principal",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -200,
        50
      ]
    },
    {
      "parameters": {
        "content": "## ‚öôÔ∏è CONFIGURACI√ìN REQUERIDA\n\n**IMPORTANTE:** Para que este workflow funcione correctamente, aseg√∫rate de:\n\n1. **Credenciales Anthropic:** Configurar API key v√°lida\n2. **Workflows de Agentes:** Los workflows \"Research Agent\" y \"Visualization Agent\" deben existir y estar activos\n3. **IDs de Workflows:** Verificar que los IDs de workflows sean correctos en los nodos de herramientas",
        "height": 150,
        "width": 350,
        "color": 2
      },
      "id": "note-configuration",
      "name": "Nota Configuraci√≥n",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        400,
        50
      ]
    }
  ],
  "pinData": {
    "When chat message received": [
      {
        "json": {
          "action": "sendMessage",
          "sessionId": "ab963d94-eecb-443c-bc5e-f65fbf7b6215",
          "chatInput": "Hola una comparativa entre banco bisa y banco nacional"
        }
      }
    ]
  },
  "connections": {
    "When chat message received": {
      "main": [
        [
          {
            "node": "Manager Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Anthropic Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Manager Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "Manager Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Research Agent": {
      "ai_tool": [
        [
          {
            "node": "Manager Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Visualization Agent": {
      "ai_tool": [
        [
          {
            "node": "Manager Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "31c8dc33-a06a-40b7-9b61-53eb822794dc",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "91f378fe60da678632cbae3dbc7580425fa46ba54eec358af5e91b61588d6d8f"
  },
  "id": "CBwSiNcC5TTHVUYZ",
  "tags": []
}